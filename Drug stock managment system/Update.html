<!DOCTYPE html>
<html>
<head>
  <title>Save Web Form Data to Spreadsheets</title>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="preload" href="applab/fa-brands-400.woff2" as="font">
  <link rel="preload" href="applab/fa-solid-900.woff2" as="font">
  <link rel="preload" href="applab/fa-regular-400.woff2" as="font">
  <link rel="preload" href="applab/fa-v4compatibility.woff2" as="font">
  <script src="https://code.jquery.com/jquery-1.12.1.min.js"></script>
  <script>
    function setExportConfig(config) { window.EXPORT_OPTIONS = config; }
  </script>
  <script src="https://studio.code.org/projects/applab/8POioK5MEoDlHXi1lVqBB0PV-17WtHwNWDjvRc7aAFA/export_config?script_call=setExportConfig"></script>
  <script src="applab/applab-api.js"></script>
  <script src="https://www.google.com/jsapi"></script>
  <link rel="stylesheet" href="applab/applab.css">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="row">
    <div class="column" style=" width:25%;">


     <div class="container">
      <form id = "myForm">
        <label for="myInput">Name</label>
        <div class="autocomplete" style="width:300px;">
          <input type="text" class = "myInput" id="myInput" name="Name" placeholder="Name">
        </div>
        <label for="lname">Value</label>
        <input type="text" id="lname" name="lname" placeholder="Value">
    </div>
  </div>
  <div class="column" style=" width:75%;">
    <div id = "demo"></div>
  </div>


</body>
<style>
  #tble tr:nth-child(even){background-color: white;}
</style>

<script>
var reco = null;

document.getElementById("lname").addEventListener("keyup", function(event) {
  var activeElement = document.activeElement;
  var myElement = document.getElementById('lname');
  if (activeElement == myElement) {

    if(document.getElementById("lname").value != ""){
      if (event.key == "Enter") {
        for(x in reco){
          if(reco[x].Name == document.getElementById("myInput").value){

var DB1 = Number(reco[x].G_1x2);
var DB3 = Number(reco[x].G_3x4);
var DB5 = Number(reco[x].G_5x6);
var DB7 = Number(reco[x].G_7x8);
var DB9 = Number(reco[x].G_9x10);
var DB11 = Number(reco[x].G_11x12);
var DB13 = Number(reco[x].G_13x14);
var DB15 = Number(reco[x].G_15x16);
var DB17 = Number(reco[x].G_17x18);
var DB19 = Number(reco[x].G_19x20);
var DB21 = Number(reco[x].G_21x22);
var DB23 = Number(reco[x].G_23x24);
var DB25 = Number(reco[x].G_25x26);
var DB27 = Number(reco[x].G_27x28);
var DB29 = Number(reco[x].G_29x30);
var DB31 = Number(reco[x].G_31);
if((new Date().getDate() == 1)||(new Date().getDate() == 2)){
 DB1 += Number(document.getElementById('lname').value);}
if((new Date().getDate() == 3)||(new Date().getDate() == 4)){
 DB3 += Number(document.getElementById('lname').value);}
if((new Date().getDate() == 5)||(new Date().getDate() == 6)){
 DB5 += Number(document.getElementById('lname').value);}
if((new Date().getDate() == 7)||(new Date().getDate() == 8)){
 DB7 += Number(document.getElementById('lname').value);}
if((new Date().getDate() == 9)||(new Date().getDate() == 10)){
 DB9 += Number(document.getElementById('lname').value);}
if((new Date().getDate() == 11)||(new Date().getDate() == 12)){
 DB11 += Number(document.getElementById('lname').value);}
if((new Date().getDate() == 13)||(new Date().getDate() == 14)){
 DB13 += Number(document.getElementById('lname').value);}
if((new Date().getDate() == 15)||(new Date().getDate() == 16)){
 DB15 += Number(document.getElementById('lname').value);}
if((new Date().getDate() == 17)||(new Date().getDate() == 18)){
 DB17 += Number(document.getElementById('lname').value);}
if((new Date().getDate() == 19)||(new Date().getDate() == 20)){
 DB19 += Number(document.getElementById('lname').value);}
if((new Date().getDate() == 21)||(new Date().getDate() == 22)){
 DB21 += Number(document.getElementById('lname').value);}
if((new Date().getDate() == 23)||(new Date().getDate() == 24)){
 DB23 += Number(document.getElementById('lname').value);}
if((new Date().getDate() == 25)||(new Date().getDate() == 26)){
 DB25 += Number(document.getElementById('lname').value);}
if((new Date().getDate() == 27)||(new Date().getDate() == 28)){
 DB27 += Number(document.getElementById('lname').value);}
if((new Date().getDate() == 29)||(new Date().getDate() == 30)){
 DB29 += Number(document.getElementById('lname').value);}
if((new Date().getDate() == 31)){
 DB31 += Number(document.getElementById('lname').value);}
 var currid = 0;
 var currName = "";
 var cHome = 0;
 var cBalance = 0;
 var cCup = 0;
 var cTotal = 0;
 for(let y in reco){
if(reco[y].Name == document.getElementById("myInput").value){
currid = reco[y].id;
cHome = reco[y].Home;
cBalance = reco[y].Balance;
cTotal = reco[y].Total;
cCup = reco[y].Cupboard;
currName = reco[y].Name;
}
 }
cBalance = cCup-(Number(DB1)+Number(DB3)+Number(DB5)+Number(DB7)+Number(DB9)+Number(DB11)+Number(DB13)+Number(DB15)+Number(DB17)+Number(DB19)+Number(DB21)+Number(DB23)+Number(DB25)+Number(DB27)+Number(DB29)+Number(DB31));
            updateRecord("Balance sheet", {id:currid, Name:currName,Home:cHome,Balance:cBalance,Cupboard:cCup,Total:(Number(cBalance)+Number(cHome)),G_1x2:DB1,G_3x4:DB3,G_5x6:DB5,G_7x8:DB7,G_9x10:DB9,G_11x12:DB11,G_13x14:DB13,G_15x16:DB15,G_17x18:DB17,G_19x20:DB19,G_21x22:DB21,G_23x24:DB23,G_25x26:DB25,G_27x28:DB27,G_29x30:DB29,G_31:DB31}, function(record, success) {
              console.log(success);

            });
              document.getElementById("myInput").value = "";
              document.getElementById("myInput").focus();
              document.getElementById("lname").value = "";

          }
        }
      }
    }
  }
});

  
  let text = "<table id = 'tble' class = 'tble' border='1' style = \"padding:5px;\">  <tr><th>Name</th> <th>Total</th><th>Cupboard</th><th>1-2</th><th>3-4</th><th>5-6</th><th>7-8</th><th>9-10</th><th>11-12</th><th>13-14</th><th>15-16</th><th>17-18</th><th>19-20</th><th>21-22</th><th>23-24</th><th>25-26</th><th>27-28</th><th>29-30</th><th>31</th><th>Balance</th> <th>Home</th>     </tr>"
  
  readRecords("Balance sheet", {}, function(records) {
    reco = records;
    var obje = [];
    for(var i = 0;i<records.length;i++){
      obje.push(records[i].Name);
    }
    obje.sort();

    let ob = [];
    for(let i in obje){
      for(let x in records){

        if(obje[i] == records[x].Name){

          ob.push(x);
        }
      }
    }
    console.log(ob);
    for (var i =0; i < ob.length; i++) {
      x = ob[i];
    text += "<tr id = '"+records[x].Name+"' onclick='b('"+records[x].Name+"')'><td>" + records[x].Name + "</td>";
    text += "<td>" + records[x].Total + "</td>";
      text += "<td>"+ records[x].Cupboard + "</td>";
     if((new Date().getDate() == 1)||(new Date().getDate() == 2)){
text += "<td style = 'background:#FFF9A6;'>" + records[x].G_1x2 + "</td>";}
else{
text += "<td style = ''>" + records[x].G_1x2 + "</td>";}
if((new Date().getDate() == 3)||(new Date().getDate() == 4)){
text += "<td style = 'background:#FFF9A6;'>" + records[x].G_3x4 + "</td>";}
else{
text += "<td style = ''>" + records[x].G_3x4 + "</td>";}
if((new Date().getDate() == 5)||(new Date().getDate() == 6)){
text += "<td style = 'background:#FFF9A6;'>" + records[x].G_5x6 + "</td>";}
else{
text += "<td style = ''>" + records[x].G_5x6 + "</td>";}
if((new Date().getDate() == 7)||(new Date().getDate() == 8)){
text += "<td style = 'background:#FFF9A6;'>" + records[x].G_7x8 + "</td>";}
else{
text += "<td style = ''>" + records[x].G_7x8 + "</td>";}
if((new Date().getDate() == 9)||(new Date().getDate() == 10)){
text += "<td style = 'background:#FFF9A6;'>" + records[x].G_9x10 + "</td>";}
else{
text += "<td style = ''>" + records[x].G_9x10 + "</td>";}
if((new Date().getDate() == 11)||(new Date().getDate() == 12)){
text += "<td style = 'background:#FFF9A6;'>" + records[x].G_11x12 + "</td>";}
else{
text += "<td style = ''>" + records[x].G_11x12 + "</td>";}
if((new Date().getDate() == 13)||(new Date().getDate() == 14)){
text += "<td style = 'background:#FFF9A6;'>" + records[x].G_13x14 + "</td>";}
else{
text += "<td style = ''>" + records[x].G_13x14 + "</td>";}
if((new Date().getDate() == 15)||(new Date().getDate() == 16)){
text += "<td style = 'background:#FFF9A6;'>" + records[x].G_15x16 + "</td>";}
else{
text += "<td style = ''>" + records[x].G_15x16 + "</td>";}
if((new Date().getDate() == 17)||(new Date().getDate() == 18)){
text += "<td style = 'background:#FFF9A6;'>" + records[x].G_17x18 + "</td>";}
else{
text += "<td style = ''>" + records[x].G_17x18 + "</td>";}
if((new Date().getDate() == 19)||(new Date().getDate() == 20)){
text += "<td style = 'background:#FFF9A6;'>" + records[x].G_19x20 + "</td>";}
else{
text += "<td style = ''>" + records[x].G_19x20 + "</td>";}
if((new Date().getDate() == 21)||(new Date().getDate() == 22)){
text += "<td style = 'background:#FFF9A6;'>" + records[x].G_21x22 + "</td>";}
else{
text += "<td style = ''>" + records[x].G_21x22 + "</td>";}
if((new Date().getDate() == 23)||(new Date().getDate() == 24)){
text += "<td style = 'background:#FFF9A6;'>" + records[x].G_23x24 + "</td>";}
else{
text += "<td style = ''>" + records[x].G_23x24 + "</td>";}
if((new Date().getDate() == 25)||(new Date().getDate() == 26)){
text += "<td style = 'background:#FFF9A6;'>" + records[x].G_25x26 + "</td>";}
else{
text += "<td style = ''>" + records[x].G_25x26 + "</td>";}
if((new Date().getDate() == 27)||(new Date().getDate() == 28)){
text += "<td style = 'background:#FFF9A6;'>" + records[x].G_27x28 + "</td>";}
else{
text += "<td style = ''>" + records[x].G_27x28 + "</td>";}
if((new Date().getDate() == 29)||(new Date().getDate() == 30)){
text += "<td style = 'background:#FFF9A6;'>" + records[x].G_29x30 + "</td>";}
else{
text += "<td style = ''>" + records[x].G_29x30 + "</td>";}
if(new Date().getDate() == 31){
text += "<td style = 'background:#FFF9A6;'>" + records[x].G_31 + "</td>";}
else{
text += "<td style = ''>" + records[x].G_31 + "</td>";}
      text += "<td>" + records[x].Balance + "</td>";
      text += "<td>" + records[x].Home + "</td></tr>";











    }
  //console.log(text);




    text += "</table>"    
    document.getElementById("demo").innerHTML = text;
  //console.log(text);
      var countries =[];
  console.log(records[0].Name);
  for(let x in reco){
    countries.push(records[x].Name);
    console.log(records[x].Name);
  }


/*initiate the autocomplete function on the "myInput" element, and pass along the countries array as possible autocomplete values:*/
  autocomplete(document.getElementById("myInput"), countries);
  });
function myFunction(){
  document.getElementById("lname").focus();
  setTimeout(function(){
var table = document.getElementById("tble");
 var rows = table.querySelectorAll('tr');
    var line = 100;
for(let z in rows){
 //alert(rows[z].id);
if(rows[z].id == document.getElementById("myInput").value){
  line = z;
}
}
   
     
     for(let ind in rows){
      if(ind % 2 == 1){
      rows[ind].style.backgroundColor = "white";
    }
          if(ind % 2 == 0){
      rows[ind].style.backgroundColor = "#f2f2f2";
    }

     }
     rows[line].style.backgroundColor = "#62fc6f";
    rows[line].scrollIntoView({
      behavior: 'smooth',
      block: 'center'
});
 
  }, 500);

}
</script>


<style>
  body {font-family: Arial, Helvetica, sans-serif;}
  #tble {
    font-family: Arial, Helvetica, sans-serif;
    border-collapse: collapse;
    width: 100%;
  }
  table tr th {
    position: sticky;
    z-index: 100;
    top: 0;
  }
  table td, #tble th {
    border: 1px solid #ddd;
    padding: 8px;
  }



  table tr:hover {background-color: #ddd;}

  table th {
    padding-top: 12px;
    padding-bottom: 12px;
    text-align: left;
    background-color: #04AA6D;
    color: white;
  }
  * {
    box-sizing: border-box;
  }

/* Create two equal columns that floats next to each other */


/* Create two equal columns that floats next to each other */
.column {
  float: left;
  width: 50%;
  padding: 10px;
  height: 100%; /* Should be removed. Only for demonstration */
}

/* Clear floats after the columns */
.row:after {
  content: "";
  display: table;
  clear: both;
}

input[type=text], select, textarea {
  width: 100%;
  padding: 12px;
  border: 1px solid #ccc;
  border-radius: 4px;
  box-sizing: border-box;
  margin-top: 6px;
  margin-bottom: 16px;
  resize: vertical;
}

input[type=submit] {
  background-color: #04AA6D;
  color: white;
  padding: 12px 20px;
  border: none;
  border-radius: 4px;
  cursor: pointer;
}

input[type=submit]:hover {
  background-color: #45a049;
}

.container {
  border-radius: 5px;
  background-color: #f2f2f2;
  padding: 20px;
  position:absolute;
  display: block;
  position:fixed;
  width:23vw;
}
</style>







_____________________________________________________________________________________







<script>
  function autocomplete(inp, arr) {
  /*the autocomplete function takes two arguments,
  the text field element and an array of possible autocompleted values:*/
    var currentFocus;
    var fina = [];
  /*execute a function when someone writes in the text field:*/
    inp.addEventListener("input", function(e) {
      fina = [];
      var a, b, i, val = this.value;
      /*close any already open lists of autocompleted values*/
      closeAllLists();
      if (!val) { return false;}
      currentFocus = -1;
      /*create a DIV element that will contain the items (values):*/
      a = document.createElement("DIV");
      a.setAttribute("id", this.id + "autocomplete-list");
      a.setAttribute("class", "autocomplete-items");
      /*append the DIV element as a child of the autocomplete container:*/
      this.parentNode.appendChild(a);
      /*for each item in the array...*/
      for (i = 0; i < arr.length; i++) {
        /*check if the item starts with the same letters as the text field value:*/
        if (arr[i].substr(0, val.length).toUpperCase() == val.toUpperCase()) {
          /*create a DIV element for each matching element:*/
          b = document.createElement("DIV");
          /*make the matching letters bold:*/
          b.innerHTML = "<strong>" + arr[i].substr(0, val.length) + "</strong>";
          fina.push(arr[i]);
          b.innerHTML += arr[i].substr(val.length);
          
          /*insert a input field that will hold the current array item's value:*/
          b.innerHTML += "<input type='hidden' value='" + arr[i] + "'>";
          /*execute a function when someone clicks on the item value (DIV element):*/
          b.addEventListener("click", function(e) {
              /*insert the value for the autocomplete text field:*/
            inp.value = this.getElementsByTagName("input")[0].value;
            myFunction();
            document.getElementById("lname").focus();
              /*close the list of autocompleted values,
              (or any other open lists of autocompleted values:*/
            closeAllLists();
          });
          a.appendChild(b);
        }
      }
    });
  /*execute a function presses a key on the keyboard:*/
    inp.addEventListener("keydown", function(e) {
      var x = document.getElementById(this.id + "autocomplete-list");
      if (x) x = x.getElementsByTagName("div");
      if (e.keyCode == 40) {
        /*If the arrow DOWN key is pressed,
        increase the currentFocus variable:*/
        currentFocus++;
        /*and and make the current item more visible:*/
        addActive(x);
      } else if (e.keyCode == 38) { //up
        /*If the arrow UP key is pressed,
        decrease the currentFocus variable:*/
        currentFocus--;
        /*and and make the current item more visible:*/
        addActive(x);
      } else if (e.keyCode == 13) {
        /*If the ENTER key is pressed, prevent the form from being submitted,*/
        e.preventDefault();
        document.getElementById("myInput").value =fina[0];
        closeAllLists(document.getElementById("lname"));
        myFunction();
        document.getElementById("lname").focus();
        
        //alert(fina[0]);
        
        if (currentFocus > -1) {
          /*and simulate a click on the "active" item:*/
          if (x) x[currentFocus].click();
        }
       
      }
    });
    function addActive(x) {
    /*a function to classify an item as "active":*/
      if (!x) return false;
    /*start by removing the "active" class on all items:*/
      removeActive(x);
      if (currentFocus >= x.length) currentFocus = 0;
      if (currentFocus < 0) currentFocus = (x.length - 1);
    /*add class "autocomplete-active":*/
      x[currentFocus].classList.add("autocomplete-active");
    }
    function removeActive(x) {
    /*a function to remove the "active" class from all autocomplete items:*/
      for (var i = 0; i < x.length; i++) {
        x[i].classList.remove("autocomplete-active");
      }
    }
    function closeAllLists(elmnt) {
    /*close all autocomplete lists in the document,
    except the one passed as an argument:*/
      var x = document.getElementsByClassName("autocomplete-items");
      for (var i = 0; i < x.length; i++) {
        if (elmnt != x[i] && elmnt != inp) {
          x[i].parentNode.removeChild(x[i]);
        }
      }
    }
  /*execute a function when someone clicks in the document:*/
    document.addEventListener("click", function (e) {
      closeAllLists(e.target);
    });
  }

/*An array containing all the country names in the world:*/



</script>
<style>
  .autocomplete {
    position: relative;
    display: inline-block;
  }

  input {
    border: 1px solid transparent;
    background-color: #f1f1f1;
    padding: 10px;
    font-size: 16px;
  }

  input[type=text] {
    background-color: #f1f1f1;
    width: 100%;
  }

  input[type=submit] {
    background-color: DodgerBlue;
    color: #fff;
    cursor: pointer;
  }

  .autocomplete-items {
    position: absolute;
    border: 1px solid #d4d4d4;
    border-bottom: none;
    border-top: none;
    z-index: 99;
    /*position the autocomplete items to be the same width as the container:*/
    top: 100%;
    left: 0;
    right: 0;
  }

  .autocomplete-items div {
    padding: 10px;
    cursor: pointer;
    background-color: #fff; 
    border-bottom: 1px solid #d4d4d4; 
  }

/*when hovering an item:*/
.autocomplete-items div:hover {
  background-color: #e9e9e9; 
}

/*when navigating through the items using the arrow keys:*/
.autocomplete-active {
  background-color: DodgerBlue !important; 
  color: #ffffff; 
}
</style>
</html>